<div *ngIf="filme$ | async as filme" class="detalhe-filme-container">
  <div class="filme-card" (click)="toggleDetails()" (mouseenter)="onMouseEnter()" (mouseleave)="onMouseLeave()">
    @if (filme.trailerUrl) {
      <iframe
        [src]="filme.trailerUrl | safeUrl"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen
      ></iframe>
    } @else {
      <p>Nenhum trailer dispon√≠vel.</p>
    }
    <div class="filme-info">
      <h2 class="titulo-filme" (click)="showExtraDetail()">{{ filme.titulo }}</h2>
      <p *ngIf="extraDetail" class="extra-detail">Cita√ß√£o: "{{getRandomQuote()}}" - Extra√≠do do filme!</p>
      <p><strong>Sinopse:</strong> {{ filme.sinopse }}</p>
      <p><strong>Elenco:</strong> {{ filme.elenco }}</p>
      <p><strong>Diretor:</strong> {{ filme.diretor }}</p>
      <p><strong>Dura√ß√£o:</strong> {{ filme.duracao }}</p>
      <p><strong>G√™nero:</strong> {{ filme.genero }}</p>
      <p><strong>Classifica√ß√£o:</strong> {{ filme.classificacao }}</p>
      <p><strong>Visualiza√ß√µes:</strong> {{ getViewCount() }}</p>
      <div class="button-group">
        <button class="curtir-button" (click)="curtirFilme(filme.id); $event.stopPropagation()">
          <span class="curtir-icon">üëç</span>
          <span class="curtir-count">{{ filme.curtidas || 0 }}</span>
          Curtir
        </button>
        <button class="voltar-button" (click)="voltar(); $event.stopPropagation()">‚Üê Voltar</button>
        <button class="recomendar-button" (click)="showRecommendations(); $event.stopPropagation()">
          <span class="recomendar-icon">üîç</span> Recomenda√ß√µes
        </button>
      </div>
      <div *ngIf="recommendationsVisible" class="recommendations">
        <p *ngIf="recommendedMovies.length === 0">Nenhum filme dispon√≠vel para recomenda√ß√£o.</p>
        <p *ngIf="recommendedMovies.length > 0">
          <strong>Recomenda√ß√µes:</strong>
          <span *ngFor="let filme of recommendedMovies; let last = last">
            <a class="recommendation-link" [routerLink]="['/catalogo', filme.id]">{{ filme.titulo }}</a>{{ last ? '' : ', ' }}
          </span>
        </p>
      </div>
    </div>
  </div>
</div>
